<!DOCTYPE html>
<html class="full-height">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="//cdn.bootcss.com/bulma/0.4.1/css/bulma.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  
  
  <title>Nosql数据库入门 | Michaelwwx</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="NOSQL入门发展###单机MySQL的时代   数据量的总大小一个服务器存不下。  数据的索引（B+Tree）空间太大。  访问量（读写混合）一个实例不能承受。###Memcached（缓存)+MySQL+垂直拆分发展：随着访问量的上升，几乎大部分使用MySQL架构的网站在数据库上都开始出现了性能问题，web程序不再仅仅专注于功能上，同时也在追求性能。这时缓存技术的出现有效的缓解了数据库的压力">
<meta name="keywords" content="Redis NOSQL">
<meta property="og:type" content="article">
<meta property="og:title" content="Nosql数据库入门">
<meta property="og:url" content="http://michaelwwx.top/2017/08/09/Redis/index.html">
<meta property="og:site_name" content="Michaelwwx">
<meta property="og:description" content="NOSQL入门发展###单机MySQL的时代   数据量的总大小一个服务器存不下。  数据的索引（B+Tree）空间太大。  访问量（读写混合）一个实例不能承受。###Memcached（缓存)+MySQL+垂直拆分发展：随着访问量的上升，几乎大部分使用MySQL架构的网站在数据库上都开始出现了性能问题，web程序不再仅仅专注于功能上，同时也在追求性能。这时缓存技术的出现有效的缓解了数据库的压力">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://oxtprvhvb.bkt.clouddn.com/nosql.jpg">
<meta property="og:updated_time" content="2017-10-24T13:49:02.576Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nosql数据库入门">
<meta name="twitter:description" content="NOSQL入门发展###单机MySQL的时代   数据量的总大小一个服务器存不下。  数据的索引（B+Tree）空间太大。  访问量（读写混合）一个实例不能承受。###Memcached（缓存)+MySQL+垂直拆分发展：随着访问量的上升，几乎大部分使用MySQL架构的网站在数据库上都开始出现了性能问题，web程序不再仅仅专注于功能上，同时也在追求性能。这时缓存技术的出现有效的缓解了数据库的压力">
<meta name="twitter:image" content="http://oxtprvhvb.bkt.clouddn.com/nosql.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Michaelwwx" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/common.css">
<link rel="stylesheet" href="/css/nav.css">
<link rel="stylesheet" href="/css/layout.css">
 
</head>

<body>
  <header id="navbar" class="overflow-hidden">
  <div class="container">
    <nav class="nav">
    	
    	
         <div class="nav-left">
            <a href="/" class="nav-item" style="font-size: 20px;">
              <span class="logo">Michaelwwx</span>'s Blog
            </a>
         </div>
         
         
         
        <div class="nav-center is-hidden position-relative" id="search_container">
            <div class="nav-item full-width full-height">
                <i class="fa fa-search has-padding" aria-hidden="true"></i>
                <input type="text" id="search_input" class="search-input full-height full-width" placeholder="Search post" autofocus>
                <i id="close_search" class="fa fa-times" aria-hidden="true"></i>
            </div>
            <div id="search_result"></div>
        </div>
        
        
        
        <div class="nav-right nav-menu">
            <a class="nav-item" id="search">
                <i class="fa fa-search" aria-hidden="true"></i>
            </a>
            
            <a class="nav-item" href="/">
                Home
            </a>
            
            <a class="nav-item" href="/works">
                My Works
            </a>
            
            <a class="nav-item" href="/about">
                About
            </a>
            
            <a class="nav-item" href="/source">
                Source
            </a>
            
        </div>
        
        
        <span class="nav-toggle" id="navMenuDropdown">
            <span></span>
            <span></span>
            <span></span>
        </span>
        
        
        <div class="navbar-menu position-absolute full-width content-box is-hidden-desktop is-flex flex-column center" style="top: 100%;">
            
            <a class="nav-item flex-4" href="/">
                Home
            </a>
            
            <a class="nav-item flex-4" href="/works">
                My Works
            </a>
            
            <a class="nav-item flex-4" href="/about">
                About
            </a>
            
            <a class="nav-item flex-4" href="/source">
                Source
            </a>
            
        </div>
        
        
        
    </nav>
  </div>
</header>

  <div id="main-wrap" class="position-relative " style="margin-top: 55px;">
      <div class="main-inner-content">
          <!--博文页面-->

<style>
    .header-box {
        height: 370px;
        filter: blur(10px);
        background-size: cover;
        background-color: lightsteelblue;
    }

    .post-box {
        padding: 15px;
        padding-top: 60px;
        min-height: 80vh;
        margin-top: -200px;
        border-radius: 4px;
        background-color: rgba(255,255,255,.8);
    }

    .post-avatar {
        height: 30px;
        width: 30px;
        border-radius: 50%;
    }

    .flow-chart {
        text-align: center;
    }

    img[alt="post-cover"] {
        display: none;
    }
</style>
<header>
    <div id="header_box" class="header-box"></div>
</header>
<section>
    <div class="container post-box">
        <div class="content post-title is-flex center flex-column" style="margin-bottom: 70px; overflow: auto;">
            <h1 class="has-text-centered" style="padding-bottom: 10px; border-bottom: 3px solid #fff">
                <strong>Nosql数据库入门</strong>
            </h1>
            
            <div class="is-flex align-center">
                <img class="post-avatar" src="http://oxtprvhvb.bkt.clouddn.com/timg.jpg">
                <span style="padding:0 10px;"> <span class="sub-title">By</span>吴文祥</span>
                <span class="post-date sub-title">at: 2017-08-09</span>
            </div>
            
                <div>
                    
                         <a class="tag is-post-tag" href="/tags/Redis-NOSQL/">Redis NOSQL</a>
                    
                </div>
            
        </div>
        <div class="content" style="overflow: auto">
            <p><img src="http://oxtprvhvb.bkt.clouddn.com/nosql.jpg" alt="post-cover"></p>
<h1 id="NOSQL入门"><a href="#NOSQL入门" class="headerlink" title="NOSQL入门"></a>NOSQL入门</h1><h2 id="发展"><a href="#发展" class="headerlink" title="发展"></a>发展</h2><p>###单机MySQL的时代</p>
<blockquote>
<ol>
<li><p>数据量的总大小一个服务器存不下。</p>
</li>
<li><p>数据的索引（B+Tree）空间太大。</p>
</li>
<li><p>访问量（读写混合）一个实例不能承受。<br>###Memcached（缓存)+MySQL+垂直拆分<br>发展：随着访问量的上升，几乎大部分使用MySQL架构的网站在数据库上都开始出现了性能问题，web程序不再仅仅专注于功能上，同时也在追求性能。这时缓存技术的出现有效的缓解了数据库的压力。优化数据库的结构和所有。开始比较流行的是通过文件缓存来缓解数据库压力，但是当访问量继续增大时，多台web机器通过文件缓存不能共享，大量的小文件缓存带来了比较高的IO压力，这是Memcached就自然的成为了非常时尚的技术产品。<br>Memcached作为一个独立的分布式的缓存服务器，为多个web服务器提供了一个共享的高性能缓存服务，在Memcached服务器上，又发展了根据hash算法来进行多台Memcached缓存服务的扩展，然后又出现了一致性hash来解决增加或减少服务器导致重新hash带来的大量缓存失效的弊端。</p>
</li>
</ol>
</blockquote>
<p>###MySQL主从读写分离</p>
<blockquote>
<p>由于数据库的写入压力增加，Memcached只能缓解数据库的读取压力。读写集中在一个数据库上让数据库不堪重负，大部分网站开始使用主从复制技术来达到读写分离，以提高读写性能和读库的可扩展性。<br>MySQL的master-slav模式成为这个时候的网站标配。</p>
</blockquote>
<p>###分表分库+水平拆分+MySQL集群</p>
<blockquote>
<p>在Memcached的高速缓存，MySQL的主从复制，读写分离的基础之上，这时MySQL主库的写压力开始出现瓶颈，而数据量的持续猛增，由于MyISAM使用表锁，在高并发下会出现严重的锁问题，大量的高并发MySQL应用开始使用InnoDB引擎代替MyISAM。<br>同时，开始流行使用分表分库来缓解写压力和数据增长的扩展问题。这个时候，分表分库成了一个热门技术，是面试的热门问题也是业界讨论的热门技术问题。也就在这个时候，MySQL推出了还不太稳定的表分区，这也给技术实力一般的公司带来了希望。虽然MySQL推出了MySQL Cluster集群，但性能也不能很好满足互联网的要求，只是在高可靠性上提供了非常大<br>的保证。</p>
</blockquote>
<p>###MySQL的扩展性瓶颈</p>
<blockquote>
<p>MySQL数据库也经常存储一些大文本字段，导致数据库表非常的大，在做数据库恢复的时候就导致非常的慢，不容易快速恢复数据库。比如1000万4KB大小的文本就接近40GB的大小，如果能把这些数据从MySQL省去，MySQL将变得非常的小。关系数据库很强大，但是它并不能很好的应付所有的应用场景。MySQL的扩展性差（需要复杂的技术来实现），大数据下IO压力大，表结构更改困难，正是当前使用MySQL的开发人员面临的问题。</p>
</blockquote>
<p>###这个时候NOSQL的概念提出</p>
<blockquote>
<p>为什么使用NoSQL ?<br>今天我们可以通过第三方平台（如：Google,Facebook等）可以很容易的访问和抓取数据。用户的个人信息，社交网络，地理位置，用户生成的数据和用户操作日志已经成倍的增加。我们如果要对这些用户数据进行挖掘，那SQL数据库已经不适合这些应用了, NoSQL数据库的发展也却能很好的处理这些大的数据。</p>
</blockquote>
<p>#NOSQL的介绍</p>
<p>##NOSQL是什么？</p>
<blockquote>
<p>NoSQL(NoSQL = Not Only SQL )，意即“不仅仅是SQL”，<br>泛指非关系型的数据库。随着互联网web2.0网站的兴起，传统的关系数据库在应付web2.0网站，特别是超大规模和高并发的SNS类型的web2.0纯动态网站已经显得力不从心，暴露了很多难以克服的问题，而非关系型的数据库则由于其本身的特点得到了非常迅速的发展。NoSQL数据库的产生就是为了解决大规模数据集合多重数据种类带来的挑战，尤其是大数据应用难题，包括超大规模数据的存储。</p>
<p>（例如谷歌或Facebook每天为他们的用户收集万亿比特的数据）。这些类型的数据存储不需要固定的模式，无需多余操作就可以横向扩展。</p>
</blockquote>
<p>##NOSQL能干嘛?</p>
<p>###易扩展</p>
<blockquote>
<p>NoSQL数据库种类繁多，但是一个共同的特点都是去掉关系数据库的关系型特性。<br>数据之间无关系，这样就非常容易扩展。也无形之间，在架构的层面上带来了可扩展的能力。</p>
<p>###大数据量高性能</p>
<p>NoSQL数据库都具有非常高的读写性能，尤其在大数据量下，同样表现优秀。<br>这得益于它的无关系性，数据库的结构简单。<br>一般MySQL使用Query Cache，每次表的更新Cache就失效，是一种大粒度的Cache，在针对web2.0的交互频繁的应用，Cache性能不高。而NoSQL的Cache是记录级的，是一种细粒度的Cache，所以NoSQL在这个层面上来说就要性能高很多了</p>
<p>###多种灵活的数据模型<br>NoSQL无需事先为要存储的数据建立字段，随时可以存储自定义的数据格式。而在关系数据库里，<br>增删字段是一件非常麻烦的事情。如果是非常大数据量的表，增加字段简直就是一个噩梦</p>
<p>###传统RDBMS  VS  NOSQL</p>
<p><strong>RDBMS</strong><br></p>
<ol>
<li>高度组织化结构化数据<br></li>
<li>结构化查询语言（SQL）<br></li>
<li>数据和关系都存储在单独的表中。<br></li>
<li>数据操纵语言，数据定义语言<br></li>
<li>严格的一致性<br></li>
<li>基础事务<br></li>
</ol>
<p><strong>NoSQL</strong><br></p>
<ol>
<li>代表着不仅仅是SQL<br></li>
<li>没有声明性查询语言<br></li>
<li>没有预定义的模式<br></li>
<li>键 - 值对存储，列存储，文档存储，图形数据库<br></li>
<li>最终一致性，而非ACID属性<br></li>
<li>非结构化和不可预知的数据<br></li>
<li>CAP定理<br></li>
<li>高性能，高可用性和可伸缩性<br></li>
</ol>
</blockquote>
<p>##NOSQL数据库的3V+3高</p>
<blockquote>
<p><strong>3V</strong><br><br>大数据时代的3v<br></p>
<ol>
<li>海量Volume<br></li>
<li>多样Variety<br></li>
<li>实时Velocity<br></li>
</ol>
<p><strong>3高</strong><br></p>
<ol>
<li>高并发<br></li>
<li>高可扩<br></li>
<li>高性能<br></li>
</ol>
</blockquote>
<p>#NOSQL数据库的分类</p>
<p>##KV键值<br>典型介绍<br></p>
<ol>
<li>新浪：BerkeleyDB+redis<br></li>
<li>美团：redis+tair<br></li>
<li>阿里、百度：Memcache+redis<br></li>
</ol>
<p>##文档型数据库（bson格式比较多）<br>典型介绍：MongoDB</p>
<p>MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。</p>
<p>MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</p>
<p>##列存储数据库<br>Cassandra、HBASE<br><br>分布式文件系统</p>
<p>##图关系数据库<br>注意：图关系数据不是放图形的，放的是关系，比如朋友圈社交网络，广告推荐系统。<br><br>典型：Neo4j，infoGrid</p>
<p>#分布式数据库中CAP原理+BASE</p>
<p>##关系型数据库的ACID<br></p>
<ol>
<li>A:Atomicity原子性<br></li>
<li>C:Consistency一致性<br></li>
<li>I:Isolation独立性<br></li>
<li>D：Durability持久性<br><br>##分布式数据CAP原理：</li>
<li>C:Consistency（强一致性）</li>
<li>A：Availablity（可用性）</li>
<li>P:Partition tolerance（分区容错性）</li>
</ol>
<p>###CAP的3进2<br>CAP理论就是说在分布式存储系统中，最多只能实现上面的两点。<br>而由于当前的网络硬件肯定会出现延迟丢包等问题，所以<strong>分区容忍性</strong>是我们必须需要实现的</p>
<p>所以我们只能在一致性和可用性之间进行权衡，没有NoSQL系统能同时保证这三点。<br></p>
<ol>
<li>CA 传统Oracle数据库<br></li>
<li>AP 大多数网站架构的选择<br></li>
<li>CP Redis、Mongodb<br></li>
</ol>
<p>注意：分布式架构的时候必须做出取舍。<br>一致性和可用性之间取一个平衡。多余大多数web应用，其实并不需要强一致性。<br>因此牺牲C换取P，这是目前分布式数据库产品的方向</p>
<p>一致性与可用性的决择<br>对于web2.0网站来说，关系数据库的很多主要特性却往往无用武之地</p>
<p>####数据库事务一致性需求<br>　　很多web实时系统并不要求严格的数据库事务，对读一致性的要求很低， 有些场合对写一致性要求并不高。允许实现最终一致性。</p>
<p>####数据库的写实时性和读实时性需求<br>　　对关系数据库来说，插入一条数据之后立刻查询，是肯定可以读出来这条数据的，但是对于很多web应用来说，并不要求这么高的实时性，比方说发一条消息之 后，过几秒乃至十几秒之后，我的订阅者才看到这条动态是完全可以接受的。</p>
<p>####对复杂的SQL查询，特别是多表关联查询的需求<br>　　任何大数据量的web系统，都非常忌讳多个大表的关联查询，以及复杂的数据分析类型的报表查询，特别是SNS类型的网站，从需求以及产品设计角 度，就避免了这种情况的产生。往往更多的只是单表的主键查询，以及单表的简单条件分页查询，SQL的功能被极大的弱化了。</p>
<p>##BASE<br>BASE是为了解决关系数据库强一致性引起的问题而引起的可用性降低而提出的解决方案。</p>
<p>BASE其实是下面三个术语的缩写：<br></p>
<ol>
<li>基本可用（Basically Available）<br></li>
<li>软状态（Soft state）<br></li>
<li>最终一致（Eventually consistent）<br></li>
</ol>
<p><strong>它的思想是通过让系统放松对某一时刻数据一致性的要求来换取系统整体伸缩性和性能上改观</strong>。为什么这么说呢，缘由就在于大型系统往往由于地域分布和极高性能的要求，不可能采用分布式事务来完成这些指标，要想获得这些指标，我们必须采用另外一种方式来完成，这里BASE就是解决这个问题的办法</p>
<p>##分布式+集群简介</p>
<p><strong>分布式系统（distributed system）</strong><br><br> 由多台计算机和通信的软件组件通过计算机网络连接（本地网络或广域网）组成。分布式系统是建立在网络之上的软件系统。正是因为软件的特性，所以分布式系统具有高度的内聚性和透明性。因此，网络和分布式系统之间的区别更多的在于高层软件（特别是操作系统），而不是硬件。分布式系统可以应用在在不同的平台上如：Pc、工作站、局域网和广域网上等。</p>
<p>简单来讲：<br></p>
<ol>
<li>分布式：不同的多台服务器上面部署不同的服务模块（工程），他们之间通过Rpc/Rmi之间通信和调用，对外提供服务和组内协作。<br></li>
<li>集群：不同的多台服务器上面部署相同的服务模块，通过分布式调度软件进行统一的调度，对外提供服务和访问。<br></li>
</ol>

        </div>
        <div class="post-reply">
            
                <!-- 来必力City版安装代码 -->
                <div id="lv-container" data-id="city" data-uid="MTAyMC8zMTM1My83OTE2">
                    <script type="text/javascript">
                        (function(d, s) {
                            var j, e = d.getElementsByTagName(s)[0];

                            if (typeof LivereTower === 'function') { return; }

                            j = d.createElement(s);
                            j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                            j.async = true;

                            e.parentNode.insertBefore(j, e);
                        })(document, 'script');
                    </script>
                    <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
                </div>
                <!-- City版安装代码已完成 -->
            
            
            
        </div>
    </div>
</section>
<script>
    // 获取第一张图, 用以当封面背景图
    var img = document.querySelectorAll('img')[1]

    if (img) {
        var header_box = document.querySelector('#header_box')
        header_box.style.backgroundImage = 'url('+ img.src +')'
    }
</script>

      </div>
  </div>
  <style>
  #footer {
    min-height: 10vh;
    background: black;
    color: #fff;
  }

  #footer a {
    color: #e1e1e1;
  }
</style>
<footer id="footer" class="has-text-centered is-flex center">
  <div class="container has-padding">
    <div>
      <div>
        <br>
        Copyright © Michaelwwx 2017
        <br>
        
      </div>
      <div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>
    </div>
  </div>
  
</footer>

<script src="/js/search_core.js"></script>
<script src="/js/script.js"></script>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</body>

</html>